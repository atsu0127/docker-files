-- プロジェクト管理データベーススキーマ
alter session set container = freepdb1;
alter session set current_schema = project_manager;
-- プロジェクト情報テーブル
CREATE TABLE PROJECTS (
    PROJECT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROJECT_NAME VARCHAR2(100) NOT NULL,
    START_DATE DATE NOT NULL,
    END_DATE DATE,
    BUDGET NUMBER(15, 2)
);

-- 初期データ
INSERT INTO PROJECTS (PROJECT_NAME, START_DATE, END_DATE, BUDGET) VALUES
('New Website Launch', TO_DATE('2024-08-01', 'YYYY-MM-DD'), TO_DATE('2024-12-31', 'YYYY-MM-DD'), 50000),
('Mobile App Development', TO_DATE('2024-09-15', 'YYYY-MM-DD'), NULL, 150000),
('Marketing Campaign', TO_DATE('2024-10-01', 'YYYY-MM-DD'), TO_DATE('2025-03-31', 'YYYY-MM-DD'), 30000);

-- 従業員情報テーブル
CREATE TABLE EMPLOYEES (
    EMPLOYEE_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FIRST_NAME VARCHAR2(50) NOT NULL,
    LAST_NAME VARCHAR2(50) NOT NULL,
    EMAIL VARCHAR2(100),
    PHONE_NUMBER VARCHAR2(20),
    HIRE_DATE DATE
);

-- 初期データ
INSERT INTO EMPLOYEES (FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE) VALUES
('John', 'Doe', 'john.doe@example.com', '123-456-7890', TO_DATE('2022-01-15', 'YYYY-MM-DD')),
('Jane', 'Smith', 'jane.smith@example.com', '123-456-7891', TO_DATE('2023-04-23', 'YYYY-MM-DD')),
('Emily', 'Davis', 'emily.davis@example.com', '123-456-7892', TO_DATE('2021-07-30', 'YYYY-MM-DD')),
('Michael', 'Brown', 'michael.brown@example.com', '123-456-7893', TO_DATE('2020-11-10', 'YYYY-MM-DD'));

-- プロジェクトメンバーテーブル
CREATE TABLE PROJECT_MEMBERS (
    MEMBER_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROJECT_ID NUMBER NOT NULL,
    EMPLOYEE_ID NUMBER NOT NULL,
    ROLE VARCHAR2(50),
    CONSTRAINT FK_PROJECT FOREIGN KEY (PROJECT_ID) REFERENCES PROJECTS(PROJECT_ID),
    CONSTRAINT FK_EMPLOYEE FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES(EMPLOYEE_ID)
);

-- 初期データ
INSERT INTO PROJECT_MEMBERS (PROJECT_ID, EMPLOYEE_ID, ROLE) VALUES
(1, 1, 'Project Manager'),
(1, 2, 'Web Developer'),
(2, 3, 'App Developer'),
(3, 4, 'Marketing Specialist');

-- タスクテーブル
CREATE TABLE TASKS (
    TASK_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROJECT_ID NUMBER NOT NULL,
    TASK_NAME VARCHAR2(100) NOT NULL,
    ASSIGNED_TO NUMBER,
    STATUS VARCHAR2(20) DEFAULT 'Pending',
    DEADLINE DATE,
    CONSTRAINT FK_PROJECT_TASK FOREIGN KEY (PROJECT_ID) REFERENCES PROJECTS(PROJECT_ID),
    CONSTRAINT FK_ASSIGNEE FOREIGN KEY (ASSIGNED_TO) REFERENCES EMPLOYEES(EMPLOYEE_ID)
);

-- 初期データ
INSERT INTO TASKS (PROJECT_ID, TASK_NAME, ASSIGNED_TO, STATUS, DEADLINE) VALUES
(1, 'Design Homepage', 2, 'In Progress', TO_DATE('2024-09-15', 'YYYY-MM-DD')),
(1, 'Develop Backend', 2, 'Pending', TO_DATE('2024-10-01', 'YYYY-MM-DD')),
(2, 'Create App Prototype', 3, 'Pending', TO_DATE('2024-11-30', 'YYYY-MM-DD')),
(3, 'Launch Social Media Ads', 4, 'Pending', TO_DATE('2024-12-01', 'YYYY-MM-DD'));

